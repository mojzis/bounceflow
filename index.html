<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="BounceFlow - Learn physics through play">
    <title>BounceFlow - Prototype</title>
    <link rel="stylesheet" href="/src/styles/style.css">
</head>
<body>
    <div id="app">
        <canvas id="gameCanvas"></canvas>
        <div id="ui">
            <div id="property-indicator">
                <div class="property-label">Elasticity</div>
                <div class="property-bar">
                    <div id="elasticity-fill" class="property-fill"></div>
                </div>
            </div>
            <div id="controls">
                <button id="playButton" class="btn-primary">Play</button>
                <button id="replayButton" class="btn-replay" style="display: none;">Watch Replay</button>
                <button id="dropButton" class="btn-secondary">Drop Ball (Space)</button>
                <button id="restartButton" class="btn-secondary">Restart (R)</button>
                <button id="hintButton" class="btn-hint">Show Hint (?)</button>
                <button id="refineButton" class="btn-hint">Refine My Setup</button>
                <div id="level-info">
                    <span id="level-display">Level 1</span>
                    <span id="level-name" class="level-name">First Bounce</span>
                </div>
                <button id="helpButton" class="btn-help">Help (H)</button>
            </div>
            <div id="hint-box" class="hint">
                <p id="hint-text">Drag surfaces to guide the ball to the star!</p>
            </div>
            <div id="score-display" class="score-display">
                <div class="score-item">
                    <span class="score-label">Time:</span>
                    <span id="score-time" class="score-value">0s</span>
                </div>
                <div class="score-item">
                    <span class="score-label">Attempts:</span>
                    <span id="score-attempts" class="score-value">0</span>
                </div>
                <div class="score-item">
                    <span class="score-label">Score:</span>
                    <span id="score-points" class="score-value">1000</span>
                </div>
            </div>
        </div>

        <!-- Victory Overlay -->
        <div id="victory-overlay" class="victory-overlay hidden">
            <div class="victory-content">
                <h1>üéâ Level Complete!</h1>
                <p id="victory-message">Great job!</p>
                <p class="victory-footer">Loading next level...</p>
            </div>
        </div>

        <!-- Help Overlay -->
        <div id="help-overlay" class="help-overlay hidden">
            <div class="help-content">
                <button id="close-help" class="close-help">&times;</button>
                <h1>BounceFlow - Help</h1>

                <div class="help-section">
                    <h2>üéØ Goal</h2>
                    <p>Guide the bouncing ball to collect all stars by positioning and rotating surfaces!</p>
                </div>

                <div class="help-section">
                    <h2>‚å®Ô∏è Keyboard Controls</h2>
                    <div class="controls-grid">
                        <div><kbd>Tab</kbd> Select next surface</div>
                        <div><kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd> or <kbd>‚Üë</kbd><kbd>‚Üì</kbd><kbd>‚Üê</kbd><kbd>‚Üí</kbd> Move surface</div>
                        <div><kbd>Q</kbd> / <kbd>E</kbd> Rotate left/right</div>
                        <div><kbd>Shift</kbd> + <kbd>‚Üê</kbd> / <kbd>‚Üí</kbd> Rotate left/right</div>
                        <div><kbd>Shift</kbd> + movement keys 5√ó speed (coarse)</div>
                        <div><kbd>Space</kbd> Start ball / Drop ball (during play)</div>
                        <div><kbd>V</kbd> Toggle angle display</div>
                        <div><kbd>?</kbd> Run experimental solver</div>
                        <div><kbd>R</kbd> Restart level</div>
                        <div><kbd>H</kbd> Toggle this help</div>
                    </div>
                </div>

                <div class="help-section">
                    <h2>üñ±Ô∏è Mouse Controls</h2>
                    <div class="controls-grid">
                        <div><strong>Left-click + drag</strong> Move surface</div>
                        <div><strong>Right-click + drag</strong> Rotate surface</div>
                        <div><strong>Hover</strong> Highlight movable surfaces</div>
                    </div>
                </div>

                <div class="help-section">
                    <h2>üé® Visual Indicators</h2>
                    <div class="controls-grid">
                        <div><span class="color-demo" style="background: #FFE66D;"></span> <strong>Yellow</strong> = Selected (keyboard)</div>
                        <div><span class="color-demo" style="background: #4ECDC4;"></span> <strong>Cyan</strong> = Active/Dragging</div>
                        <div><span class="color-demo" style="background: #95E1D3;"></span> <strong>Light Cyan</strong> = Hovered</div>
                        <div><span class="color-demo" style="background: #555;"></span> <strong>Gray</strong> = Locked (unmovable)</div>
                    </div>
                </div>

                <div class="help-section">
                    <h2>‚ö° The Physics</h2>
                    <p>The <strong>Elasticity bar</strong> shows the ball's current bounciness:</p>
                    <ul>
                        <li><span style="color: #FF6B6B;">‚óè</span> <strong>Red/Orange</strong> = Low bounce (ball won't bounce high)</li>
                        <li><span style="color: #4ECDC4;">‚óè</span> <strong>Cyan/Green</strong> = High bounce (ball bounces really high)</li>
                    </ul>
                    <p>In later levels, the ball's properties change over time - watch the color!</p>
                </div>

                <div class="help-section">
                    <h2>üí° Tips & Hints</h2>
                    <ul>
                        <li>Surfaces are thicker than they look - collision detection is generous</li>
                        <li>You can adjust surfaces while the ball is bouncing</li>
                        <li>Try different angles - there are multiple solutions!</li>
                        <li><strong>Stuck?</strong> Press <kbd>?</kbd> or click "Show Hint" to run the experimental solver</li>
                        <li>Watch as the solver tries different configurations (faint red lines)</li>
                        <li>When found, the solution appears as cyan dashed surfaces with angles</li>
                        <li>The solver adapts to random star positions - every hint is custom!</li>
                    </ul>
                </div>

                <p class="help-footer">Press <kbd>H</kbd> or <kbd>Esc</kbd> to close</p>
            </div>
        </div>
    </div>
    <script type="module" src="/src/main.js"></script>
</body>
</html>
